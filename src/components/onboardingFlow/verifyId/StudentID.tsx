'use client'
import React, { useRef, useState } from 'react'
import Image from "next/image";
import UploadImgIcons from '../../../../public/images/upload-img-icons.png'
import Link from 'next/link';

interface UploadedImage {
  id: string;
  file: File;
  preview: string;
}

const StudentID = () => {
     const [frontImage, setFrontImage] = useState<UploadedImage | null>(null);
  const [backImage, setBackImage] = useState<UploadedImage | null>(null);

  const frontInputRef = useRef<HTMLInputElement>(null);
  const backInputRef = useRef<HTMLInputElement>(null);

  const handleSingleUpload = (
    files: FileList | null,
    setImage: React.Dispatch<React.SetStateAction<UploadedImage | null>>
  ) => {
    if (!files || files.length === 0) return;
    const file = files[0];
    const newImage = {
      id: URL.createObjectURL(file),
      file,
      preview: URL.createObjectURL(file),
    };
    setImage(newImage);
  };

  const handleRemove = (
    setImage: React.Dispatch<React.SetStateAction<UploadedImage | null>>,
    inputRef: React.RefObject<HTMLInputElement | null>
  ) => {
    setImage(null);
    if (inputRef.current) inputRef.current.value = '';
  };

  const handleOpenFile = (inputRef: React.RefObject<HTMLInputElement | null>) => {
    inputRef.current?.click();
  };

  return (
    <div>
        <div className='verify-com-box text-center'>
              <div className='verify-box'>
                <div className='form-box d-flex flex-wrap gap-3'>
                  {frontImage ? (
                    <div className='image-box position-relative'>
                      <img src={frontImage.preview} alt='Front Preview' className='uploaded-img' />
                      <div className='d-flex gap-2 btn-box justify-content-center'>
                        <button type='button' className='remove-btn d-flex align-items-center gap-2' onClick={() => handleRemove(setFrontImage, frontInputRef)}>
                            <svg width="12" height="13" viewBox="0 0 12 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 2H9V1.5C9 1.10218 8.84196 0.720644 8.56066 0.43934C8.27936 0.158035 7.89782 0 7.5 0H4.5C4.10218 0 3.72064 0.158035 3.43934 0.43934C3.15804 0.720644 3 1.10218 3 1.5V2H0.5C0.367392 2 0.240215 2.05268 0.146447 2.14645C0.0526785 2.24021 0 2.36739 0 2.5C0 2.63261 0.0526785 2.75979 0.146447 2.85355C0.240215 2.94732 0.367392 3 0.5 3H1V12C1 12.2652 1.10536 12.5196 1.29289 12.7071C1.48043 12.8946 1.73478 13 2 13H10C10.2652 13 10.5196 12.8946 10.7071 12.7071C10.8946 12.5196 11 12.2652 11 12V3H11.5C11.6326 3 11.7598 2.94732 11.8536 2.85355C11.9473 2.75979 12 2.63261 12 2.5C12 2.36739 11.9473 2.24021 11.8536 2.14645C11.7598 2.05268 11.6326 2 11.5 2ZM4 1.5C4 1.36739 4.05268 1.24021 4.14645 1.14645C4.24021 1.05268 4.36739 1 4.5 1H7.5C7.63261 1 7.75979 1.05268 7.85355 1.14645C7.94732 1.24021 8 1.36739 8 1.5V2H4V1.5ZM10 12H2V3H10V12ZM5 5.5V9.5C5 9.63261 4.94732 9.75979 4.85355 9.85355C4.75979 9.94732 4.63261 10 4.5 10C4.36739 10 4.24021 9.94732 4.14645 9.85355C4.05268 9.75979 4 9.63261 4 9.5V5.5C4 5.36739 4.05268 5.24021 4.14645 5.14645C4.24021 5.05268 4.36739 5 4.5 5C4.63261 5 4.75979 5.05268 4.85355 5.14645C4.94732 5.24021 5 5.36739 5 5.5ZM8 5.5V9.5C8 9.63261 7.94732 9.75979 7.85355 9.85355C7.75979 9.94732 7.63261 10 7.5 10C7.36739 10 7.24021 9.94732 7.14645 9.85355C7.05268 9.75979 7 9.63261 7 9.5V5.5C7 5.36739 7.05268 5.24021 7.14645 5.14645C7.24021 5.05268 7.36739 5 7.5 5C7.63261 5 7.75979 5.05268 7.85355 5.14645C7.94732 5.24021 8 5.36739 8 5.5Z" fill="#DF1738"/></svg>
                          Remove
                        </button>
                        <button type='button' className='change-btn d-flex align-items-center gap-2' onClick={() => handleOpenFile(frontInputRef)}>
                            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0.879685V3.87968C12 4.01229 11.9473 4.13947 11.8536 4.23324C11.7598 4.32701 11.6326 4.37968 11.5 4.37968H8.5C8.36739 4.37968 8.24021 4.32701 8.14645 4.23324C8.05268 4.13947 8 4.01229 8 3.87968C8 3.74708 8.05268 3.6199 8.14645 3.52613C8.24021 3.43236 8.36739 3.37968 8.5 3.37968H10.2931L9.37875 2.46531C8.44948 1.53181 7.1878 1.00516 5.87063 1.00093H5.8425C4.53636 0.997873 3.28151 1.50911 2.34937 2.42406C2.25389 2.5132 2.12731 2.56143 1.99672 2.55843C1.86612 2.55544 1.74189 2.50145 1.65059 2.40803C1.55929 2.31461 1.50817 2.18916 1.50818 2.05854C1.50819 1.92791 1.55932 1.80247 1.65062 1.70906C2.78033 0.604932 4.29988 -0.00914092 5.87952 0.000102868C7.45916 0.00934666 8.97142 0.641162 10.0881 1.75843L11 2.67281V0.879685C11 0.747076 11.0527 0.619899 11.1464 0.526131C11.2402 0.432363 11.3674 0.379685 11.5 0.379685C11.6326 0.379685 11.7598 0.432363 11.8536 0.526131C11.9473 0.619899 12 0.747076 12 0.879685ZM9.65063 9.33531C8.70927 10.2548 7.44337 10.7662 6.12747 10.7585C4.81156 10.7507 3.55175 10.2246 2.62125 9.29406L1.70688 8.37968H3.5C3.63261 8.37968 3.75979 8.32701 3.85355 8.23324C3.94732 8.13947 4 8.01229 4 7.87968C4 7.74708 3.94732 7.6199 3.85355 7.52613C3.75979 7.43236 3.63261 7.37968 3.5 7.37968H0.5C0.367392 7.37968 0.240215 7.43236 0.146447 7.52613C0.0526785 7.6199 0 7.74708 0 7.87968V10.8797C0 11.0123 0.0526785 11.1395 0.146447 11.2332C0.240215 11.327 0.367392 11.3797 0.5 11.3797C0.632608 11.3797 0.759785 11.327 0.853553 11.2332C0.947321 11.1395 1 11.0123 1 10.8797V9.08656L1.91438 10.0009C3.02951 11.1217 4.544 11.7538 6.125 11.7584H6.15812C7.72568 11.7625 9.23171 11.1488 10.35 10.0503C10.4413 9.9569 10.4924 9.83146 10.4924 9.70083C10.4925 9.5702 10.4413 9.44476 10.35 9.35134C10.2587 9.25792 10.1345 9.20393 10.0039 9.20094C9.87332 9.19794 9.74674 9.24617 9.65125 9.33531H9.65063Z" fill="#1F2230"/></svg>
                          Change
                        </button>
                      </div>
                      <input type='file' accept='image/*' ref={frontInputRef} style={{ display: 'none' }} onChange={(e) => handleSingleUpload(e.target.files, setFrontImage)}/>
                    </div>
                  ) : (
                    <div className='upload-box text-center' onClick={() => handleOpenFile(frontInputRef)} onDrop={(e) => { e.preventDefault(); handleSingleUpload(e.dataTransfer.files, setFrontImage); }} onDragOver={(e) => e.preventDefault()} >
                      <div>
                        <Image src={UploadImgIcons} alt='' />
                        <h6>Upload front of ID</h6>
                        <p>Ensure the image is clear and not blurry.</p>
                        <div className='upload-text-img d-flex align-items-center justify-content-center px-3 py-3'>
                          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.75 10.625V15.625C18.75 15.9565 18.6183 16.2745 18.3839 16.5089C18.1495 16.7433 17.8315 16.875 17.5 16.875H2.5C2.16848 16.875 1.85054 16.7433 1.61612 16.5089C1.3817 16.2745 1.25 15.9565 1.25 15.625V10.625C1.25 10.2935 1.3817 9.97554 1.61612 9.74112C1.85054 9.5067 2.16848 9.375 2.5 9.375H6.25C6.41576 9.375 6.57473 9.44085 6.69194 9.55806C6.80915 9.67527 6.875 9.83424 6.875 10C6.875 10.1658 6.80915 10.3247 6.69194 10.4419C6.57473 10.5592 6.41576 10.625 6.25 10.625H2.5V15.625H17.5V10.625H13.75C13.5842 10.625 13.4253 10.5592 13.3081 10.4419C13.1908 10.3247 13.125 10.1658 13.125 10C13.125 9.83424 13.1908 9.67527 13.3081 9.55806C13.4253 9.44085 13.5842 9.375 13.75 9.375H17.5C17.8315 9.375 18.1495 9.5067 18.3839 9.74112C18.6183 9.97554 18.75 10.2935 18.75 10.625ZM6.69219 6.06719L9.375 3.3836V10C9.375 10.1658 9.44085 10.3247 9.55806 10.4419C9.67527 10.5592 9.83424 10.625 10 10.625C10.1658 10.625 10.3247 10.5592 10.4419 10.4419C10.5592 10.3247 10.625 10.1658 10.625 10V3.3836L13.3078 6.06719C13.4251 6.18447 13.5841 6.25035 13.75 6.25035C13.9159 6.25035 14.0749 6.18447 14.1922 6.06719C14.3095 5.94992 14.3753 5.79086 14.3753 5.625C14.3753 5.45915 14.3095 5.30009 14.1922 5.18282L10.4422 1.43282C10.3841 1.37471 10.3152 1.32861 10.2393 1.29715C10.1635 1.2657 10.0821 1.24951 10 1.24951C9.91787 1.24951 9.83654 1.2657 9.76066 1.29715C9.68479 1.32861 9.61586 1.37471 9.55781 1.43282L5.80781 5.18282C5.69054 5.30009 5.62465 5.45915 5.62465 5.625C5.62465 5.79086 5.69054 5.94992 5.80781 6.06719C5.92509 6.18447 6.08415 6.25035 6.25 6.25035C6.41585 6.25035 6.57491 6.18447 6.69219 6.06719ZM15.625 13.125C15.625 12.9396 15.57 12.7583 15.467 12.6042C15.364 12.45 15.2176 12.3298 15.0463 12.2589C14.875 12.1879 14.6865 12.1693 14.5046 12.2055C14.3227 12.2417 14.1557 12.331 14.0246 12.4621C13.8935 12.5932 13.8042 12.7603 13.768 12.9421C13.7318 13.124 13.7504 13.3125 13.8214 13.4838C13.8923 13.6551 14.0125 13.8015 14.1667 13.9045C14.3208 14.0075 14.5021 14.0625 14.6875 14.0625C14.9361 14.0625 15.1746 13.9637 15.3504 13.7879C15.5262 13.6121 15.625 13.3736 15.625 13.125Z" fill="currentColor"/></svg>
                          <span>Upload</span>
                        </div>
                      </div>
                      <input type='file' accept='image/*' ref={frontInputRef} style={{ display: 'none' }} onChange={(e) => handleSingleUpload(e.target.files, setFrontImage)}/>
                    </div>
                  )}
                </div>
              </div>

              <div className='verify-box'>
                <div className='form-box d-flex flex-wrap gap-3'>
                  {backImage ? (
                    <div className='image-box position-relative'>
                      <img src={backImage.preview} alt='Back Preview' className='uploaded-img' />
                      
                      <div className='d-flex gap-2 btn-box justify-content-center'>
                        <button type='button' className='remove-btn d-flex align-items-center gap-2' onClick={() => handleRemove(setBackImage, backInputRef)} >
                            <svg width="12" height="13" viewBox="0 0 12 13" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M11.5 2H9V1.5C9 1.10218 8.84196 0.720644 8.56066 0.43934C8.27936 0.158035 7.89782 0 7.5 0H4.5C4.10218 0 3.72064 0.158035 3.43934 0.43934C3.15804 0.720644 3 1.10218 3 1.5V2H0.5C0.367392 2 0.240215 2.05268 0.146447 2.14645C0.0526785 2.24021 0 2.36739 0 2.5C0 2.63261 0.0526785 2.75979 0.146447 2.85355C0.240215 2.94732 0.367392 3 0.5 3H1V12C1 12.2652 1.10536 12.5196 1.29289 12.7071C1.48043 12.8946 1.73478 13 2 13H10C10.2652 13 10.5196 12.8946 10.7071 12.7071C10.8946 12.5196 11 12.2652 11 12V3H11.5C11.6326 3 11.7598 2.94732 11.8536 2.85355C11.9473 2.75979 12 2.63261 12 2.5C12 2.36739 11.9473 2.24021 11.8536 2.14645C11.7598 2.05268 11.6326 2 11.5 2ZM4 1.5C4 1.36739 4.05268 1.24021 4.14645 1.14645C4.24021 1.05268 4.36739 1 4.5 1H7.5C7.63261 1 7.75979 1.05268 7.85355 1.14645C7.94732 1.24021 8 1.36739 8 1.5V2H4V1.5ZM10 12H2V3H10V12ZM5 5.5V9.5C5 9.63261 4.94732 9.75979 4.85355 9.85355C4.75979 9.94732 4.63261 10 4.5 10C4.36739 10 4.24021 9.94732 4.14645 9.85355C4.05268 9.75979 4 9.63261 4 9.5V5.5C4 5.36739 4.05268 5.24021 4.14645 5.14645C4.24021 5.05268 4.36739 5 4.5 5C4.63261 5 4.75979 5.05268 4.85355 5.14645C4.94732 5.24021 5 5.36739 5 5.5ZM8 5.5V9.5C8 9.63261 7.94732 9.75979 7.85355 9.85355C7.75979 9.94732 7.63261 10 7.5 10C7.36739 10 7.24021 9.94732 7.14645 9.85355C7.05268 9.75979 7 9.63261 7 9.5V5.5C7 5.36739 7.05268 5.24021 7.14645 5.14645C7.24021 5.05268 7.36739 5 7.5 5C7.63261 5 7.75979 5.05268 7.85355 5.14645C7.94732 5.24021 8 5.36739 8 5.5Z" fill="#DF1738"/></svg>
                          Remove
                        </button>
                        <button type='button' className='change-btn d-flex align-items-center gap-2' onClick={() => handleOpenFile(backInputRef)}>
                            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 0.879685V3.87968C12 4.01229 11.9473 4.13947 11.8536 4.23324C11.7598 4.32701 11.6326 4.37968 11.5 4.37968H8.5C8.36739 4.37968 8.24021 4.32701 8.14645 4.23324C8.05268 4.13947 8 4.01229 8 3.87968C8 3.74708 8.05268 3.6199 8.14645 3.52613C8.24021 3.43236 8.36739 3.37968 8.5 3.37968H10.2931L9.37875 2.46531C8.44948 1.53181 7.1878 1.00516 5.87063 1.00093H5.8425C4.53636 0.997873 3.28151 1.50911 2.34937 2.42406C2.25389 2.5132 2.12731 2.56143 1.99672 2.55843C1.86612 2.55544 1.74189 2.50145 1.65059 2.40803C1.55929 2.31461 1.50817 2.18916 1.50818 2.05854C1.50819 1.92791 1.55932 1.80247 1.65062 1.70906C2.78033 0.604932 4.29988 -0.00914092 5.87952 0.000102868C7.45916 0.00934666 8.97142 0.641162 10.0881 1.75843L11 2.67281V0.879685C11 0.747076 11.0527 0.619899 11.1464 0.526131C11.2402 0.432363 11.3674 0.379685 11.5 0.379685C11.6326 0.379685 11.7598 0.432363 11.8536 0.526131C11.9473 0.619899 12 0.747076 12 0.879685ZM9.65063 9.33531C8.70927 10.2548 7.44337 10.7662 6.12747 10.7585C4.81156 10.7507 3.55175 10.2246 2.62125 9.29406L1.70688 8.37968H3.5C3.63261 8.37968 3.75979 8.32701 3.85355 8.23324C3.94732 8.13947 4 8.01229 4 7.87968C4 7.74708 3.94732 7.6199 3.85355 7.52613C3.75979 7.43236 3.63261 7.37968 3.5 7.37968H0.5C0.367392 7.37968 0.240215 7.43236 0.146447 7.52613C0.0526785 7.6199 0 7.74708 0 7.87968V10.8797C0 11.0123 0.0526785 11.1395 0.146447 11.2332C0.240215 11.327 0.367392 11.3797 0.5 11.3797C0.632608 11.3797 0.759785 11.327 0.853553 11.2332C0.947321 11.1395 1 11.0123 1 10.8797V9.08656L1.91438 10.0009C3.02951 11.1217 4.544 11.7538 6.125 11.7584H6.15812C7.72568 11.7625 9.23171 11.1488 10.35 10.0503C10.4413 9.9569 10.4924 9.83146 10.4924 9.70083C10.4925 9.5702 10.4413 9.44476 10.35 9.35134C10.2587 9.25792 10.1345 9.20393 10.0039 9.20094C9.87332 9.19794 9.74674 9.24617 9.65125 9.33531H9.65063Z" fill="#1F2230"/></svg>
                          Change
                        </button>
                      </div>
                      <input type='file' accept='image/*' ref={backInputRef} style={{ display: 'none' }} onChange={(e) => handleSingleUpload(e.target.files, setBackImage)}/>
                    </div>
                  ) : (
                    <div className='upload-box text-center' onClick={() => handleOpenFile(backInputRef)} onDrop={(e) => { e.preventDefault(); handleSingleUpload(e.dataTransfer.files, setBackImage); }} onDragOver={(e) => e.preventDefault()} >
                      <div>
                        <Image src={UploadImgIcons} alt='' />
                        <h6>Upload back of ID</h6>
                        <p>Ensure the image is clear and not blurry.</p>
                        <div className='upload-text-img d-flex align-items-center justify-content-center px-3 py-3'>
                          <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M18.75 10.625V15.625C18.75 15.9565 18.6183 16.2745 18.3839 16.5089C18.1495 16.7433 17.8315 16.875 17.5 16.875H2.5C2.16848 16.875 1.85054 16.7433 1.61612 16.5089C1.3817 16.2745 1.25 15.9565 1.25 15.625V10.625C1.25 10.2935 1.3817 9.97554 1.61612 9.74112C1.85054 9.5067 2.16848 9.375 2.5 9.375H6.25C6.41576 9.375 6.57473 9.44085 6.69194 9.55806C6.80915 9.67527 6.875 9.83424 6.875 10C6.875 10.1658 6.80915 10.3247 6.69194 10.4419C6.57473 10.5592 6.41576 10.625 6.25 10.625H2.5V15.625H17.5V10.625H13.75C13.5842 10.625 13.4253 10.5592 13.3081 10.4419C13.1908 10.3247 13.125 10.1658 13.125 10C13.125 9.83424 13.1908 9.67527 13.3081 9.55806C13.4253 9.44085 13.5842 9.375 13.75 9.375H17.5C17.8315 9.375 18.1495 9.5067 18.3839 9.74112C18.6183 9.97554 18.75 10.2935 18.75 10.625ZM6.69219 6.06719L9.375 3.3836V10C9.375 10.1658 9.44085 10.3247 9.55806 10.4419C9.67527 10.5592 9.83424 10.625 10 10.625C10.1658 10.625 10.3247 10.5592 10.4419 10.4419C10.5592 10.3247 10.625 10.1658 10.625 10V3.3836L13.3078 6.06719C13.4251 6.18447 13.5841 6.25035 13.75 6.25035C13.9159 6.25035 14.0749 6.18447 14.1922 6.06719C14.3095 5.94992 14.3753 5.79086 14.3753 5.625C14.3753 5.45915 14.3095 5.30009 14.1922 5.18282L10.4422 1.43282C10.3841 1.37471 10.3152 1.32861 10.2393 1.29715C10.1635 1.2657 10.0821 1.24951 10 1.24951C9.91787 1.24951 9.83654 1.2657 9.76066 1.29715C9.68479 1.32861 9.61586 1.37471 9.55781 1.43282L5.80781 5.18282C5.69054 5.30009 5.62465 5.45915 5.62465 5.625C5.62465 5.79086 5.69054 5.94992 5.80781 6.06719C5.92509 6.18447 6.08415 6.25035 6.25 6.25035C6.41585 6.25035 6.57491 6.18447 6.69219 6.06719ZM15.625 13.125C15.625 12.9396 15.57 12.7583 15.467 12.6042C15.364 12.45 15.2176 12.3298 15.0463 12.2589C14.875 12.1879 14.6865 12.1693 14.5046 12.2055C14.3227 12.2417 14.1557 12.331 14.0246 12.4621C13.8935 12.5932 13.8042 12.7603 13.768 12.9421C13.7318 13.124 13.7504 13.3125 13.8214 13.4838C13.8923 13.6551 14.0125 13.8015 14.1667 13.9045C14.3208 14.0075 14.5021 14.0625 14.6875 14.0625C14.9361 14.0625 15.1746 13.9637 15.3504 13.7879C15.5262 13.6121 15.625 13.3736 15.625 13.125Z" fill="currentColor"/></svg>
                          <span>Upload</span>
                        </div>
                      </div>
                      <input type='file' accept='image/*' ref={backInputRef} style={{ display: 'none' }} onChange={(e) => handleSingleUpload(e.target.files, setBackImage)} />
                    </div>
                  )}
                </div>
              </div>
            </div>
            <div className='btn-box-upload mt-5 mx-auto text-center'>
                <Link href="" className='btn-theme btn-yellow submit-btn'>Submit for Verification</Link>
            </div>
    </div>
  )
}

export default StudentID